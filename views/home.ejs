<html>
    <head>
        <title>Message-X | Home</title>
        <link rel="shortcut icon" href="/favicon/favicon.ico" type="image/x-icon">
        <link rel="stylesheet" href="/css/header.css">
        <link rel="stylesheet" href="/css/profile-style.css">
        <link rel="stylesheet" href="/css/home.css">
        <meta name="viewport" content="width=device-width, initial-scale= 1">
        
    </head>

    <body>


        <header>
            <div class="header-logo">
                <h2 ><span>Message-</span>X</h2>
               
            </div>
           
            <div class="form">
                <form action="/search-user" method="POST">
                    <input type="text" name="name" id="user" placeholder="Search">
                    <input type="hidden" name="hidden" value="false">
                </form>
            </div>
            <div class="header-link">
                <ul>
                    

                    <li style="text-transform: capitalize; pointer-events: none;">
                        <%= name %>
                    </li>
                    
                    <li><a href="/sign-out">Sign out</a></li>
                    
                </ul>
            </div>   
            
            <div class="menu">
                <div class="menu-bar"></div>
                <div class="menu-bar"></div>
                <div class="menu-bar"></div>
            </div>

        </header>

        <!-- <div id="checkbox" style="width: 4rem; height: 4rem; background-color: green;"></div> -->

        <script>
            document.getElementsByClassName('menu')[0].addEventListener('click' , function(){
                let headerStyle = document.getElementsByClassName('header-link')[0].style.display;
                if(headerStyle == 'block'){
                    document.getElementsByClassName('header-link')[0].style.display ="none";
                } else{
                    document.getElementsByClassName('header-link')[0].style.display ="block";
                }
                
            });
        </script>
        <main>
            <div class="message-box">
                <h2>Messages</h2>
    
                <div class="message">
                    <ul>
                        <% if(message.length<=0){ %>
                            <li><h3>No messages yet</h3></li>
                            
                        <% } %> 
                         
                        <% for(let i of message){ %>
                           

                                 <% if(i.visible == self){ %>
                                    
                                        <% if(i.sentTo._id != self){ %>
                                            <a href="/search-user?name=<%=i.sentTo._id%>&hidden=false">
                                           <% }else{ %> 
                                            <a href="/search-user?name=<%=i.sentBy._id%>&hidden=false">
                                       <% } %> 


                                        <li>
                                            <div class="message-name">
                                                <% if(i.sentTo._id != self){ %>
                                                     <h3><%=i.sentTo.name %></h3>
                                                    <% }else{ %> 
                                                     <h3><%=i.sentBy.name %></h3>
                                                <% } %> 
                                                <p><%= i.message %></p>
                                            </div>
        
                                            <div class="mesage-detaill">
                                                <% if(i.sentTo._id != self){ %>
                                                    <p>Sent</p>
                                                <% }else{ %> 
                                                    <p>Received</p>
                                               <% } %> 
                                            </div> 
                                        </li>
                                    </a>
                                    

                                 <% }else{ %> 

                                    <!-- <a href="/search-user?name=<%=i.sentBy._id%>&hidden=true"> -->
                                        <% if(i.sentTo._id != self){ %>
                                            <a href="/search-user?name=<%=i.sentTo._id%>&hidden=true">
                                           <% }else{ %> 
                                            <a href="/search-user?name=<%=i.sentBy._id%>&hidden=true">
                                       <% } %> 

                                        <li>
                                            <div class="message-name">
                                                <h3>Mr. X</h3>
                                                <p><%= i.message %></p>
                                            </div>
    
                                            <div class="mesage-detaill">
                                                <p>Received</p>
                                            </div> 
                                        </li>
                                    </a>
                                   
                                 <% } %>                               
                            
                            <% } %>

                        
                    </ul>
                </div>
            </div>
        </main>

        
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.js"></script>
    </body>
</html>